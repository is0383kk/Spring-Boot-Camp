# セッション管理

## SpringにおけるModelの振る舞い
Spring FrameworkにおけるBeanは、原則１クラスに１インスタンスがDIコンテナ内で管理されている。  
したがって、複数のブラウザからリクエスト要求があった場合でも１つのコントローラが使い回されることとなる。  
言い換えると、コントローラクラスのフィールドは、アクセスされるブラウザ毎に個別のデータを保持することはできない。  
Modelはクライアントからリクエストがある度に生成され、ブラウザにレスポンスを返した時点で消えてしまう。したがって、Modelに格納したデータは複数のブラウザ間で共有されない。

## セッション管理  
セッション管理とは、クライアント毎に固有のデータを複数のリクエストを跨いで保持、共有することができる機能である。  
- セッション管理の流れ
  - リクエスト時
    - リクエストを受けた際、Session IDをリクエストパラメータ・Cookieから取得できない場合、アプリケーションサーバは、アプリケーション内で一意なSession IDを付けた「HttpSession」オブジェクトを生成する
    - Session IDがリクエストパラメータ・Cookieに入っている場合、そのSession IDに対した「HttpSession」オブジェクトを生成する
    - WEBアプリケーションは、「HttpSession」オブジェクトに属性名と値をセットで格納できる。また、属性名を指定し対応する値を取り出すことができる
  - レスポンス時
    - クライアントにレスポンスを返す際、アプリケーションサーバはSession IDが入ったCookieを返す
    - レスポンスのHTMLデータにURLがあると、Session IDをリクエストパラメータとして追加して返す
    - セッションの有効期限が切れるとそのSession IDは無効化される

